!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e){t.exports=scene},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(0);var i=0,a=1,u=2,s=3,h=Math.PI/4;function l(t,e){var n=Math.atan2(t.y-e.y,e.x-t.x);return-h<n&&h>=n?a:h<n&&3*h>=n?i:3*h<n||3*-h>=n?s:u}var c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Ellipse),o(e,[{key:"_draw_count",value:function(t,e,n,o,i,a,u){u=u/2+u/2*i/(o||1),t.font=r.Component.font({fontFamily:a,fontSize:u}),t.fillText(String(i),e,n+u/2)}},{key:"_draw_inout",value:function(t){var e=this.model,n=e.fontFamily,o=void 0===n?r.DEFAULT.FONT_FAMILY:n,i=e.fontSize,a=void 0===i?20:i,u=this.bounds,s=this.outs.reduce(function(t,e){return t+e},0);t.fillStyle="navy",this._draw_count(t,u.left+u.width/2,u.top-20,s,this.outs[0],o,a),this._draw_count(t,u.left+u.width+10,u.top+u.height/2,s,this.outs[1],o,a),this._draw_count(t,u.left+u.width/2,u.top+u.height+20,s,this.outs[2],o,a),this._draw_count(t,u.left-30,u.top+u.height/2,s,this.outs[3],o,a),s=this.ins.reduce(function(t,e){return t+e},0),t.fillStyle="red",this._draw_count(t,u.left+u.width/2,u.top+20,s,this.ins[0],o,a),this._draw_count(t,u.left+u.width-30,u.top+u.height/2,s,this.ins[1],o,a),this._draw_count(t,u.left+u.width/2,u.top+u.height-20,s,this.ins[2],o,a),this._draw_count(t,u.left+10,u.top+u.height/2,s,this.ins[3],o,a)}},{key:"_post_draw",value:function(t){(function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_post_draw",this).call(this,t),this._draw_arrows(t),this._draw_inout(t)}},{key:"is3dish",value:function(){return!1}},{key:"_in",value:function(t){-1==this.molist.indexOf(t)&&(this.molist.push(t),this.ins[l(this.center,t.center)]++)}},{key:"_out",value:function(t){var e=this.molist.indexOf(t);-1!==e&&(this.molist.splice(e,1),this.outs[l(this.center,t.center)]++)}},{key:"_draw_arrows",value:function(t){for(var e=0;e<4;e++){var n=this._caculateArrowSizeAmplifier(e);this._draw_arrow(t,n,e)}}},{key:"_draw_arrow",value:function(t,e,n){var o=Math.PI/2*n,r=this.center,i=this.bounds,a=(i.left,i.top,i.width),u=i.height,s=a,h=u;n%2==1&&(h=a,s=u);var l=.5*s,c=.25*h*e;t.translate(r.x,r.y),t.rotate(o),t.beginPath(),t.fillStyle="green",t.moveTo(0,-.5*h-c),t.lineTo(.5*l,-.5*h-.5*c),t.lineTo(.25*l,-.5*h-.5*c),t.lineTo(.25*l,-.5*h),t.lineTo(-.25*l,-.5*h),t.lineTo(-.25*l,-.5*h-.5*c),t.lineTo(-.5*l,-.5*h-.5*c),t.lineTo(0,-.5*h-c),t.moveTo(r.x,r.y),t.fill(),t.closePath(),t.rotate(-o),t.translate(-r.x,-r.y)}},{key:"_caculateArrowSizeAmplifier",value:function(t){var e=1+this.outs[t]/(this.outs.reduce(function(t,e){return t+e},0)||1);return e>1.4?1.4:e}},{key:"onchange_mo",value:function(t,e,n){if(t.hasOwnProperty("left")||t.hasOwnProperty("top")){var o=n.origin,r=(n.deliverer,o.center);this.contains(r.x,r.y)?this._in(o):this._out(o)}}},{key:"onremove_mo",value:function(t,e){this._out(e)}},{key:"count",get:function(){return this.molist.length}},{key:"text",get:function(){return String(this.molist.length)}},{key:"outs",get:function(){return this._outs||(this._outs=[0,0,0,0]),this._outs}},{key:"ins",get:function(){return this._ins||(this._ins=[0,0,0,0]),this._ins}},{key:"molist",get:function(){return this._molist||(this._molist=[]),this._molist}},{key:"eventMap",get:function(){return{"(root)":{mo:{change:this.onchange_mo,removed:this.onremove_mo}}}}}]),e}();e.default=c,r.Component.register("landmark",c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(0);var i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,r.RectPath)(r.Shape)),o(e,[{key:"_pre_draw",value:function(t){if(this.get("trace")){var n=this.center;t.beginPath();var o=this.trace.length;this.trace.forEach(function(e,n){0==n?t.moveTo(e.x,e.y):n<o-1&&t.lineTo(e.x,e.y)}),t.lineTo(n.x+this.delta("tx"),n.y+this.delta("ty")),t.strokeStyle=this.get("strokeStyle"),t.stroke()}(function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_pre_draw",this).call(this,t)}},{key:"_draw",value:function(t){var e=this.model,n=e.top,o=e.left,r=e.width,i=e.height,a=(e.strokeStyle,this.center);t.beginPath(),t.moveTo(a.x,n+i/4),t.lineTo(o+r,n),t.lineTo(a.x,n+i),t.lineTo(o,n),t.lineTo(a.x,n+i/4)}},{key:"is3dish",value:function(){return!1}},{key:"onchange",value:function(t,e){var n=t.hasOwnProperty("left"),o=t.hasOwnProperty("top"),r=t.hasOwnProperty("rotation");if(n||o||r){var i=this;if(n&&(this.dx=t.left-e.left),o&&(this.dy=t.top-e.top),(n||o)&&this.trace.push(this.center),r){var a=t.rotation%(2*Math.PI);a<-Math.PI&&(a+=2*Math.PI),a>Math.PI&&(a-=2*Math.PI);var u=(e.rotation||0)%(2*Math.PI);u<-Math.PI&&(u+=2*Math.PI),u>Math.PI&&(u-=2*Math.PI),this.dtheta=a-u,this.dtheta>Math.PI?this.dtheta-=2*Math.PI:this.dtheta<-Math.PI&&(this.dtheta+=2*Math.PI)}this.dx&&this.delta("tx",-this.dx),this.dy&&this.delta("ty",-this.dy),this.dtheta&&this.delta("theta",-this.dtheta),this.animate({step:function(t){i.dx&&i.delta("tx",-i.dx*(1-t)),i.dy&&i.delta("ty",-i.dy*(1-t)),i.dtheta&&i.delta("theta",-i.dtheta*(1-t)),i.invalidate(),t>=1&&(delete i.dx,delete i.dy,delete i.dtheta)},delta:"linear"}).start()}}},{key:"hasTextProperty",get:function(){return!1}},{key:"trace",get:function(){return this._trace||(this._trace=[]),this._trace}}]),e}();e.default=i,r.Component.register("mo",i)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2);Object.defineProperty(e,"Mo",{enumerable:!0,get:function(){return i(o).default}});var r=n(1);function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"Landmark",{enumerable:!0,get:function(){return i(r).default}})},function(t,e,n){t.exports=n(3)}]);
//# sourceMappingURL=things-scene-slam.js.map