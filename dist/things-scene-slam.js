!function(t){var e={};function i(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(r,o,function(e){return t[e]}.bind(null,o));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e){t.exports=scene},function(t,e,i){t.exports=i(2)},function(t,e,i){"use strict";i.r(e);var r=i(0);class o extends(Object(r.RectPath)(r.Shape)){_pre_draw(t){if(this.get("trace")){var e=this.center;t.beginPath();var i=this.trace.length;this.trace.forEach(function(e,r){0==r?t.moveTo(e.x,e.y):r<i-1&&t.lineTo(e.x,e.y)}),t.lineTo(e.x+this.delta("tx"),e.y+this.delta("ty")),t.strokeStyle=this.get("strokeStyle"),t.stroke()}super._pre_draw(t)}_draw(t){var{top:e,left:i,width:r,height:o,strokeStyle:n}=this.model,s=this.center;t.beginPath(),t.moveTo(s.x,e+o/4),t.lineTo(i+r,e),t.lineTo(s.x,e+o),t.lineTo(i,e),t.lineTo(s.x,e+o/4)}is3dish(){return!1}get hasTextProperty(){return!1}get trace(){return this._trace||(this._trace=[]),this._trace}onchange(t,e){var i=t.hasOwnProperty("left"),r=t.hasOwnProperty("top"),o=t.hasOwnProperty("rotation");if(i||r||o){var n=this;if(i&&(this.dx=t.left-e.left),r&&(this.dy=t.top-e.top),(i||r)&&this.trace.push(this.center),o){var s=t.rotation%(2*Math.PI);s<-Math.PI&&(s+=2*Math.PI),s>Math.PI&&(s-=2*Math.PI);var h=(e.rotation||0)%(2*Math.PI);h<-Math.PI&&(h+=2*Math.PI),h>Math.PI&&(h-=2*Math.PI),this.dtheta=s-h,this.dtheta>Math.PI?this.dtheta-=2*Math.PI:this.dtheta<-Math.PI&&(this.dtheta+=2*Math.PI)}this.dx&&this.delta("tx",-this.dx),this.dy&&this.delta("ty",-this.dy),this.dtheta&&this.delta("theta",-this.dtheta),this.animate({step:function(t){n.dx&&n.delta("tx",-n.dx*(1-t)),n.dy&&n.delta("ty",-n.dy*(1-t)),n.dtheta&&n.delta("theta",-n.dtheta*(1-t)),n.invalidate(),t>=1&&(delete n.dx,delete n.dy,delete n.dtheta)},delta:"linear"}).start()}}}r.Component.register("mo",o);const n=0,s=1,h=2,a=3,l=Math.PI/4;function d(t,e){var i=Math.atan2(t.y-e.y,e.x-t.x);return-l<i&&l>=i?s:l<i&&3*l>=i?n:3*l<i||3*-l>=i?a:h}class u extends r.Ellipse{_draw_count(t,e,i,o,n,s,h){h=h/2+h/2*n/(o||1),t.font=r.Component.font({fontFamily:s,fontSize:h}),t.fillText(String(n),e,i+h/2)}_draw_inout(t){var{fontFamily:e=r.DEFAULT.FONT_FAMILY,fontSize:i=20}=this.model,o=this.bounds,n=this.outs.reduce((t,e)=>t+e,0);t.fillStyle="navy",this._draw_count(t,o.left+o.width/2,o.top-20,n,this.outs[0],e,i),this._draw_count(t,o.left+o.width+10,o.top+o.height/2,n,this.outs[1],e,i),this._draw_count(t,o.left+o.width/2,o.top+o.height+20,n,this.outs[2],e,i),this._draw_count(t,o.left-30,o.top+o.height/2,n,this.outs[3],e,i),n=this.ins.reduce((t,e)=>t+e,0),t.fillStyle="red",this._draw_count(t,o.left+o.width/2,o.top+20,n,this.ins[0],e,i),this._draw_count(t,o.left+o.width-30,o.top+o.height/2,n,this.ins[1],e,i),this._draw_count(t,o.left+o.width/2,o.top+o.height-20,n,this.ins[2],e,i),this._draw_count(t,o.left+10,o.top+o.height/2,n,this.ins[3],e,i)}_post_draw(t){super._post_draw(t),this._draw_arrows(t),this._draw_inout(t)}is3dish(){return!1}get count(){return this.molist.length}get text(){return String(this.molist.length)}get outs(){return this._outs||(this._outs=[0,0,0,0]),this._outs}get ins(){return this._ins||(this._ins=[0,0,0,0]),this._ins}get molist(){return this._molist||(this._molist=[]),this._molist}_in(t){-1==this.molist.indexOf(t)&&(this.molist.push(t),this.ins[d(this.center,t.center)]++)}_out(t){var e=this.molist.indexOf(t);-1!==e&&(this.molist.splice(e,1),this.outs[d(this.center,t.center)]++)}_draw_arrows(t){for(var e=0;e<4;e++){var i=this._caculateArrowSizeAmplifier(e);this._draw_arrow(t,i,e)}}_draw_arrow(t,e,i){var r=Math.PI/2*i,o=this.center,{left:n,top:s,width:h,height:a}=this.bounds,l=h,d=a;i%2==1&&(d=h,l=a);var u=.5*l,c=.25*d*e;t.translate(o.x,o.y),t.rotate(r),t.beginPath(),t.fillStyle="green",t.moveTo(0,-.5*d-c),t.lineTo(.5*u,-.5*d-.5*c),t.lineTo(.25*u,-.5*d-.5*c),t.lineTo(.25*u,-.5*d),t.lineTo(-.25*u,-.5*d),t.lineTo(-.25*u,-.5*d-.5*c),t.lineTo(-.5*u,-.5*d-.5*c),t.lineTo(0,-.5*d-c),t.moveTo(o.x,o.y),t.fill(),t.closePath(),t.rotate(-r),t.translate(-o.x,-o.y)}_caculateArrowSizeAmplifier(t){var e=1+this.outs[t]/(this.outs.reduce((t,e)=>t+e,0)||1);return e>1.4?1.4:e}get eventMap(){return{"(root)":{mo:{change:this.onchange_mo,removed:this.onremove_mo}}}}onchange_mo(t,e,i){if(t.hasOwnProperty("left")||t.hasOwnProperty("top")){var{origin:r,deliverer:o}=i,n=r.center;this.contains(n.x,n.y)?this._in(r):this._out(r)}}onremove_mo(t,e){this._out(e)}}r.Component.register("landmark",u),i.d(e,"Mo",function(){return o}),i.d(e,"Landmark",function(){return u})}]);
//# sourceMappingURL=things-scene-slam.js.map